---
title: "laba4"
author: "Abdullina"
date: '20 декабря 2016 г '
output: html_document
---
#1. Загрузите датафрейм cats (посмотреть описание датафрейма можно при помощи команды help(cats)) из пакета MASS, при помощи команд: library(MASS) data(cats).

```{r}
library(MASS)
data(cats)
```

#2. Выполните команду summary(cats) и опишите результат.
```{r}
summary(cats)
```
#Данные о котах и кошках, включающие следующие значения:
#Sex - пол
#Bwt - вес тела в кг
#Hwt -вес сердца в г



#3. Рассчитайте среднее (mean), среднеквадратичное отклонение (sd) и дисперсию (var) веса кошачьих сердец.
```{r}
mean(cats$Hwt)
sd(cats$Hwt)
var(cats$Hwt)
```

#4. При помощи полученных значений и формул выше, рассчитайте параметры a и s. Округлите до разумного числа знаков.
```{r}
a <- round((mean(cats$Hwt)**2/var(cats$Hwt)),2)
s <- round((var(cats$Hwt)/mean(cats$Hwt)),2)
```


#5. Напишите функцию для расчёта параметров a и s через дисперсию и среднее для передаваемого вектора чисел. Функция должна зазываться my.gamma и возвращать рассчитанные параметры в виде именованного вектора.
```{r}
my.gamma <- function(x) {
  m <- mean(x)
  v <- var(x)
  a <- m**2/v
  s <- v/m
  return(c(a=a,s=s))
}
```

#6. Какие результаты возвращает функция для вектора весов сердец? Сходятся ли они с ответами в п. 4? Должны сходиться?
```{r}
round(my.gamma(cats$Hwt),2)
```
#Ответы с п.4 сходятся

#7. Постройте гистограмму весов. Добавьте на гистограмму кривую плотности вероятности при помощи функций curve и dgamma, указав ранее найденные параметры формы и масштаба.
```{r}
hist(cats$Hwt,probability=T)
curve(dgamma(x,shape=a,scale=s),add=T)
```

#8. Получите параметры a и s отдельно для котов и кошек, использовав функцию my.gamma.
```{r}
F<-round(my.gamma(cats$Hwt[cats$Sex=='F']),2) #Кошки
M<-round(my.gamma(cats$Hwt[cats$Sex=='M']),2) #Коты
```

#9. Постройте полученные функции распределения на одном графике, используя curve и dgamma.
```{r}
hist(cats$Hwt,ylim=c(0,0.3),probability=T,breaks=50)
curve(dgamma(x,shape=F[1],scale=F[2]),add=T,col='336666') 
curve(dgamma(x,shape=M[1],scale=M[2]),add=T,col='336600')
```

#10. Случайным образом разделите данные на две группы одного размера равного количеству котов и кошек соответственно. Получите гамма-параметры для обеих групп. Повторите эксперимент несколько раз. Найдите среднюю разницу между результатами групп.
```{r}
F1<-cats[which(cats$Sex=='F'),]
M1<-cats[which(cats$Sex=='M'),]
cr<-data.frame()
for (it in 1:5) {
F2<-sample(dim(F1)[1]); 
F2.1<-F2[1:as.integer(length(F2)/2)];
F2.2<-F2[ceiling(length(F2)/2):length(F2)];
M2<-sample(dim(M1)[1]); 
M2.1<-M2[1:as.integer(length(M2)/2)];
M2.2<-M2[ceiling(length(M2)/2):length(M2)];
FM.1<-rbind(F1[F2.1,],M1[M2.1,])
FM.2<-rbind(F1[F2.2,],M1[M2.2,])
fm<- data.frame(my.gamma(FM.1$Hwt),my.gamma(FM.2$Hwt))
cr<-rbind(cr,fm)
}

```

#11. Данные a и s в каждом из экспериментов меняются в зависимости от случайной перестановки величин, поэтому они разные.